DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `inserirPost`(IN `_autor` VARCHAR(100), IN `_titulo` VARCHAR(100), IN `_artigo` TEXT, IN `_post` VARCHAR(20))
BEGIN
	DECLARE idp varchar(20);
    
    SELECT idTipoP into idp FROM tipop WHERE nome = _post;
    IF idp IS NOT null THEN 
    	INSERT INTO post (autor,msg,titulo,dataHora,idTipoP) VALUES(_autor,_artigo,_titulo,now(),idp);
    ELSE
    	INSERT INTO tipop (idTipoP,nome) VALUES('null',_post);
        SELECT idTipoP into idp FROM tipop WHERE nome = _post;
        INSERT INTO post (autor,msg,titulo,dataHora,idTipoP) VALUES(_autor,_artigo,_titulo,now(),idp);
    end IF;
End$$
DELIMITER ;

DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `lerPosts`(IN `_tipo` VARCHAR(20), IN `_n` INT(1))
BEGIN
	DECLARE cod SMALLINT(4);
    SELECT idTipoP into cod FROM tipop WHERE nome = _tipo; 
    IF (_n = 1) THEN
    	SELECT idPost, autor, titulo FROM post WHERE idTipoP = cod;
    ELSEIF (_n = 2) THEN 
    	SELECT idPost,autor, msg,titulo, dataHora FROM post WHERE idTipoP = cod ORDER BY idPost DESC;
    ELSEIF (_n = 3) THEN
    	SELECT idPost, autor, msg,titulo, dataHora FROM post WHERE idTipoP = cod ORDER BY idPost DESC LIMIT 1;
    END IF;
END$$
DELIMITER ;
